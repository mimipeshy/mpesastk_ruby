  [1m[35m (1.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (4.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (2.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateMpesas (20230317104624)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE TABLE "mpesas" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "phoneNumber" varchar, "amount" varchar, "checkoutRequestID" varchar, "merchantRequestID" varchar, "MpesaReceiptNumber" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20230317104624"]]
  [1m[36mTRANSACTION (4.0ms)[0m  [1m[36mcommit transaction[0m
Migrating to CreateAccessTokens (20230317104738)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE TABLE "access_tokens" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "token" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES (?)[0m  [["version", "20230317104738"]]
  [1m[36mTRANSACTION (3.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "environment"], ["value", "development"], ["created_at", "2023-03-17 10:48:15.689663"], ["updated_at", "2023-03-17 10:48:15.689663"]]
  [1m[36mTRANSACTION (2.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked host: dee0-41-80-112-231.in.ngrok.io
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked host: dee0-41-80-112-231.in.ngrok.io
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked host: dee0-41-80-112-231.in.ngrok.io
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked host: dee0-41-80-112-231.in.ngrok.io
Started GET "/" for 41.80.112.231 at 2023-03-17 14:32:44 +0300
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Rails::WelcomeController#index as HTML
  Rendering /home/peshy/.rbenv/versions/3.0.1/lib/ruby/gems/3.0.0/gems/railties-6.1.7.3/lib/rails/templates/rails/welcome/index.html.erb
  Rendered /home/peshy/.rbenv/versions/3.0.1/lib/ruby/gems/3.0.0/gems/railties-6.1.7.3/lib/rails/templates/rails/welcome/index.html.erb (Duration: 10.6ms | Allocations: 431)
Completed 200 OK in 24ms (Views: 15.0ms | ActiveRecord: 0.0ms | Allocations: 3772)


Started GET "/favicon.ico" for 41.80.112.231 at 2023-03-17 14:32:52 +0300
  
ActionController::RoutingError (No route matches [GET] "/favicon.ico"):
  
Started GET "/" for 41.80.113.195 at 2023-03-18 19:00:08 +0300
  [1m[35m (1.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Rails::WelcomeController#index as HTML
  Rendering /home/peshy/.rbenv/versions/3.0.1/lib/ruby/gems/3.0.0/gems/railties-6.1.7.3/lib/rails/templates/rails/welcome/index.html.erb
  Rendered /home/peshy/.rbenv/versions/3.0.1/lib/ruby/gems/3.0.0/gems/railties-6.1.7.3/lib/rails/templates/rails/welcome/index.html.erb (Duration: 11.2ms | Allocations: 431)
Completed 200 OK in 20ms (Views: 14.4ms | ActiveRecord: 0.0ms | Allocations: 3371)


Started GET "/favicon.ico" for 41.80.113.195 at 2023-03-18 19:00:12 +0300
  
ActionController::RoutingError (No route matches [GET] "/favicon.ico"):
  
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 19:15:55 +0300
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
Completed 500 Internal Server Error in 617ms (ActiveRecord: 1.1ms | Allocations: 4452)


  
RestClient::BadRequest (400 Bad Request):
  
app/controllers/application_controller.rb:99:in `generate_access_token_request'
app/controllers/application_controller.rb:106:in `get_access_token'
app/controllers/application_controller.rb:27:in `stkpush'
Started GET "/" for 41.80.113.195 at 2023-03-18 19:16:15 +0300
Processing by Rails::WelcomeController#index as HTML
  Rendering /home/peshy/.rbenv/versions/3.0.1/lib/ruby/gems/3.0.0/gems/railties-6.1.7.3/lib/rails/templates/rails/welcome/index.html.erb
  Rendered /home/peshy/.rbenv/versions/3.0.1/lib/ruby/gems/3.0.0/gems/railties-6.1.7.3/lib/rails/templates/rails/welcome/index.html.erb (Duration: 10.0ms | Allocations: 213)
Completed 200 OK in 13ms (Views: 11.7ms | ActiveRecord: 0.0ms | Allocations: 1018)


Started GET "/favicon.ico" for 41.80.113.195 at 2023-03-18 19:16:18 +0300
  
ActionController::RoutingError (No route matches [GET] "/favicon.ico"):
  
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 19:17:10 +0300
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
Completed 500 Internal Server Error in 631ms (ActiveRecord: 1.0ms | Allocations: 2359)


  
RestClient::BadRequest (400 Bad Request):
  
app/controllers/application_controller.rb:99:in `generate_access_token_request'
app/controllers/application_controller.rb:106:in `get_access_token'
app/controllers/application_controller.rb:27:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 19:19:00 +0300
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
Completed 500 Internal Server Error in 558ms (ActiveRecord: 0.8ms | Allocations: 2371)


  
RestClient::BadRequest (400 Bad Request):
  
app/controllers/mpesas_controller.rb:99:in `generate_access_token_request'
app/controllers/mpesas_controller.rb:106:in `get_access_token'
app/controllers/mpesas_controller.rb:27:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 19:20:23 +0300
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
Completed 500 Internal Server Error in 510ms (ActiveRecord: 0.4ms | Allocations: 6332)


  
RestClient::BadRequest (400 Bad Request):
  
app/controllers/mpesas_controller.rb:101:in `generate_access_token_request'
app/controllers/mpesas_controller.rb:108:in `get_access_token'
app/controllers/mpesas_controller.rb:29:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 19:20:55 +0300
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
Completed 500 Internal Server Error in 602ms (ActiveRecord: 1.4ms | Allocations: 2401)


  
RestClient::BadRequest (400 Bad Request):
  
app/controllers/mpesas_controller.rb:101:in `generate_access_token_request'
app/controllers/mpesas_controller.rb:108:in `get_access_token'
app/controllers/mpesas_controller.rb:29:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 19:23:52 +0300
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
Completed 500 Internal Server Error in 591ms (ActiveRecord: 0.0ms | Allocations: 1940)


  
RestClient::BadRequest (400 Bad Request):
  
app/controllers/mpesas_controller.rb:101:in `generate_access_token_request'
app/controllers/mpesas_controller.rb:108:in `get_access_token'
app/controllers/mpesas_controller.rb:29:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 19:25:13 +0300
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
Completed 500 Internal Server Error in 544ms (ActiveRecord: 0.9ms | Allocations: 2351)


  
RestClient::BadRequest (400 Bad Request):
  
app/controllers/mpesas_controller.rb:101:in `generate_access_token_request'
app/controllers/mpesas_controller.rb:108:in `get_access_token'
app/controllers/mpesas_controller.rb:29:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 22:40:04 +0300
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
Completed 500 Internal Server Error in 892ms (ActiveRecord: 0.3ms | Allocations: 6343)


  
RestClient::BadRequest (400 Bad Request):
  
app/controllers/mpesas_controller.rb:101:in `generate_access_token_request'
app/controllers/mpesas_controller.rb:108:in `get_access_token'
app/controllers/mpesas_controller.rb:29:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 22:43:57 +0300
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.9ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:117:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:118:in `get_access_token'
  [1m[36mAccessToken Create (0.9ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "XjghiA2TWVudR9LM7725cgtGwbmA"], ["created_at", "2023-03-18 19:43:59.245165"], ["updated_at", "2023-03-18 19:43:59.245165"]]
  â†³ app/controllers/mpesas_controller.rb:118:in `get_access_token'
  [1m[36mTRANSACTION (5.2ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:118:in `get_access_token'
Completed 500 Internal Server Error in 2623ms (ActiveRecord: 8.7ms | Allocations: 12870)


  
RuntimeError (Invalid response {
                    "requestId":"109190-101729553-1",
                    "errorCode": "404.001.03",
                    "errorMessage": "Invalid Access Token"
                }
             received.):
  
app/controllers/mpesas_controller.rb:46:in `block in stkpush'
app/controllers/mpesas_controller.rb:37:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 22:44:43 +0300
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.3ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mAccessToken Destroy (0.4ms)[0m  [1m[31mDELETE FROM "access_tokens" WHERE "access_tokens"."id" = ?[0m  [["id", 1]]
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mTRANSACTION (2.9ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:82:in `get_access_token'
  [1m[36mAccessToken Create (0.4ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "S4Q3aJH1O1BSnevNOvV5lQrEVDpm"], ["created_at", "2023-03-18 19:44:44.754714"], ["updated_at", "2023-03-18 19:44:44.754714"]]
  â†³ app/controllers/mpesas_controller.rb:82:in `get_access_token'
  [1m[36mTRANSACTION (2.6ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:82:in `get_access_token'
Completed 500 Internal Server Error in 1465ms (ActiveRecord: 8.6ms | Allocations: 15614)


  
RuntimeError (Invalid response {
                    "requestId":"37403-98373953-1",
                    "errorCode": "404.001.03",
                    "errorMessage": "Invalid Access Token"
                }
             received.):
  
app/controllers/mpesas_controller.rb:46:in `block in stkpush'
app/controllers/mpesas_controller.rb:37:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 22:44:50 +0300
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.1ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mAccessToken Destroy (0.5ms)[0m  [1m[31mDELETE FROM "access_tokens" WHERE "access_tokens"."id" = ?[0m  [["id", 2]]
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mTRANSACTION (2.8ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:82:in `get_access_token'
  [1m[36mAccessToken Create (0.4ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "ukJ1TwDaFYfXtGnATn2Yl02Qvebm"], ["created_at", "2023-03-18 19:44:51.426698"], ["updated_at", "2023-03-18 19:44:51.426698"]]
  â†³ app/controllers/mpesas_controller.rb:82:in `get_access_token'
  [1m[36mTRANSACTION (4.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:82:in `get_access_token'
Completed 500 Internal Server Error in 1108ms (ActiveRecord: 8.1ms | Allocations: 11966)


  
RuntimeError (Invalid response {
                    "requestId":"42501-39526737-2",
                    "errorCode": "404.001.03",
                    "errorMessage": "Invalid Access Token"
                }
             received.):
  
app/controllers/mpesas_controller.rb:46:in `block in stkpush'
app/controllers/mpesas_controller.rb:37:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 22:47:01 +0300
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
Completed 500 Internal Server Error in 1216ms (ActiveRecord: 0.7ms | Allocations: 2372)


  
RestClient::BadRequest (400 Bad Request):
  
app/controllers/mpesas_controller.rb:62:in `generate_access_token_request'
app/controllers/mpesas_controller.rb:67:in `get_access_token'
app/controllers/mpesas_controller.rb:29:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 22:48:21 +0300
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
Completed 500 Internal Server Error in 709ms (ActiveRecord: 1.0ms | Allocations: 2362)


  
RestClient::BadRequest (400 Bad Request):
  
app/controllers/mpesas_controller.rb:62:in `generate_access_token_request'
app/controllers/mpesas_controller.rb:67:in `get_access_token'
app/controllers/mpesas_controller.rb:29:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 22:53:32 +0300
  [1m[35m (0.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
Completed 500 Internal Server Error in 721ms (ActiveRecord: 0.6ms | Allocations: 6343)


  
RestClient::BadRequest (400 Bad Request):
  
app/controllers/mpesas_controller.rb:62:in `generate_access_token_request'
app/controllers/mpesas_controller.rb:67:in `get_access_token'
app/controllers/mpesas_controller.rb:29:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 23:21:52 +0300
  [1m[35m (1.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.3ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mAccessToken Destroy (0.4ms)[0m  [1m[31mDELETE FROM "access_tokens" WHERE "access_tokens"."id" = ?[0m  [["id", 3]]
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mTRANSACTION (9.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mAccessToken Create (0.4ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "dKL9uoiwkZFyLlvE3fgKfmULAQ2u"], ["created_at", "2023-03-18 20:21:53.269263"], ["updated_at", "2023-03-18 20:21:53.269263"]]
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (3.6ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
Completed 500 Internal Server Error in 1286ms (ActiveRecord: 15.3ms | Allocations: 21032)


  
RuntimeError (Invalid response {
                    "requestId":"24471-100057585-1",
                    "errorCode": "404.001.03",
                    "errorMessage": "Invalid Access Token"
                }
             received.):
  
app/controllers/mpesas_controller.rb:46:in `block in stkpush'
app/controllers/mpesas_controller.rb:37:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 23:22:59 +0300
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.2ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mAccessToken Destroy (0.4ms)[0m  [1m[31mDELETE FROM "access_tokens" WHERE "access_tokens"."id" = ?[0m  [["id", 4]]
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mTRANSACTION (4.0ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mAccessToken Create (1.1ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "bZGPAyjnK8XL2QSmdUH8NwSygeKt"], ["created_at", "2023-03-18 20:22:59.638708"], ["updated_at", "2023-03-18 20:22:59.638708"]]
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (3.2ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
Completed 500 Internal Server Error in 1049ms (ActiveRecord: 9.0ms | Allocations: 11988)


  
RuntimeError (Invalid response {
                    "requestId":"25699-100760836-1",
                    "errorCode": "404.001.03",
                    "errorMessage": "Invalid Access Token"
                }
             received.):
  
app/controllers/mpesas_controller.rb:46:in `block in stkpush'
app/controllers/mpesas_controller.rb:37:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 23:24:40 +0300
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.2ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mAccessToken Destroy (1.4ms)[0m  [1m[31mDELETE FROM "access_tokens" WHERE "access_tokens"."id" = ?[0m  [["id", 5]]
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mTRANSACTION (2.8ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mAccessToken Create (0.4ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "V3dVNSjmACHA6VGy3DeSuEM1yPPR"], ["created_at", "2023-03-18 20:24:40.853134"], ["updated_at", "2023-03-18 20:24:40.853134"]]
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (3.3ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
Completed 500 Internal Server Error in 1095ms (ActiveRecord: 8.3ms | Allocations: 11913)


  
RuntimeError (Invalid response {
                    "requestId":"24455-100063557-1",
                    "errorCode": "404.001.03",
                    "errorMessage": "Invalid Access Token"
                }
             received.):
  
app/controllers/mpesas_controller.rb:46:in `block in stkpush'
app/controllers/mpesas_controller.rb:37:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 23:25:03 +0300
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.2ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mAccessToken Destroy (0.5ms)[0m  [1m[31mDELETE FROM "access_tokens" WHERE "access_tokens"."id" = ?[0m  [["id", 6]]
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mTRANSACTION (2.4ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:77:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mAccessToken Create (0.3ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "MpPzrcFv52tyBDABGZt0IdonSe9A"], ["created_at", "2023-03-18 20:25:04.131872"], ["updated_at", "2023-03-18 20:25:04.131872"]]
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (2.9ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
Completed 500 Internal Server Error in 922ms (ActiveRecord: 6.6ms | Allocations: 11888)


  
RuntimeError (Invalid response {
                    "requestId":"25713-100765112-1",
                    "errorCode": "404.001.03",
                    "errorMessage": "Invalid Access Token"
                }
             received.):
  
app/controllers/mpesas_controller.rb:46:in `block in stkpush'
app/controllers/mpesas_controller.rb:37:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 23:26:25 +0300
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.3ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:122:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:122:in `get_access_token'
  [1m[36mAccessToken Destroy (0.4ms)[0m  [1m[31mDELETE FROM "access_tokens" WHERE "access_tokens"."id" = ?[0m  [["id", 7]]
  â†³ app/controllers/mpesas_controller.rb:122:in `get_access_token'
  [1m[36mTRANSACTION (6.3ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:122:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:123:in `get_access_token'
  [1m[36mAccessToken Create (0.4ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "T10l9ay2OJnUAhE1NR9Kh8HeD2Nl"], ["created_at", "2023-03-18 20:26:26.088451"], ["updated_at", "2023-03-18 20:26:26.088451"]]
  â†³ app/controllers/mpesas_controller.rb:123:in `get_access_token'
  [1m[36mTRANSACTION (4.3ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:123:in `get_access_token'
Completed 500 Internal Server Error in 1182ms (ActiveRecord: 13.5ms | Allocations: 15164)


  
RuntimeError (Invalid response {
                    "requestId":"42514-39627780-1",
                    "errorCode": "404.001.03",
                    "errorMessage": "Invalid Access Token"
                }
             received.):
  
app/controllers/mpesas_controller.rb:90:in `block in stkpush'
app/controllers/mpesas_controller.rb:81:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 23:28:49 +0300
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.3ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mAccessToken Destroy (0.4ms)[0m  [1m[31mDELETE FROM "access_tokens" WHERE "access_tokens"."id" = ?[0m  [["id", 8]]
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (3.3ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:79:in `get_access_token'
  [1m[36mAccessToken Create (0.4ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "WWZ8DAYwybg2ozwJgIuvMrpGOe8r"], ["created_at", "2023-03-18 20:28:50.170571"], ["updated_at", "2023-03-18 20:28:50.170571"]]
  â†³ app/controllers/mpesas_controller.rb:79:in `get_access_token'
  [1m[36mTRANSACTION (2.5ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:79:in `get_access_token'
Completed 500 Internal Server Error in 1206ms (ActiveRecord: 9.2ms | Allocations: 15143)


  
RuntimeError (Invalid response {
                    "requestId":"42513-39632758-1",
                    "errorCode": "404.001.03",
                    "errorMessage": "Invalid Access Token"
                }
             received.):
  
app/controllers/mpesas_controller.rb:46:in `block in stkpush'
app/controllers/mpesas_controller.rb:37:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 23:29:43 +0300
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.2ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mAccessToken Destroy (0.5ms)[0m  [1m[31mDELETE FROM "access_tokens" WHERE "access_tokens"."id" = ?[0m  [["id", 9]]
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (2.3ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:79:in `get_access_token'
  [1m[36mAccessToken Create (0.3ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "u129RxmaJmUsbsErXxAbaZa1dsWz"], ["created_at", "2023-03-18 20:29:44.289092"], ["updated_at", "2023-03-18 20:29:44.289092"]]
  â†³ app/controllers/mpesas_controller.rb:79:in `get_access_token'
  [1m[36mTRANSACTION (4.6ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:79:in `get_access_token'
Completed 500 Internal Server Error in 1317ms (ActiveRecord: 8.2ms | Allocations: 11954)


  
RuntimeError (Invalid response {
                    "requestId":"101025-101903759-2",
                    "errorCode": "404.001.03",
                    "errorMessage": "Invalid Access Token"
                }
             received.):
  
app/controllers/mpesas_controller.rb:46:in `block in stkpush'
app/controllers/mpesas_controller.rb:37:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 23:30:08 +0300
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.2ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mAccessToken Destroy (0.5ms)[0m  [1m[31mDELETE FROM "access_tokens" WHERE "access_tokens"."id" = ?[0m  [["id", 10]]
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (4.4ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:79:in `get_access_token'
  [1m[36mAccessToken Create (0.5ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "g9x3vmFi77rbBdL2oLsLcFDGAc9N"], ["created_at", "2023-03-18 20:30:09.132975"], ["updated_at", "2023-03-18 20:30:09.132975"]]
  â†³ app/controllers/mpesas_controller.rb:79:in `get_access_token'
  [1m[36mTRANSACTION (4.1ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:79:in `get_access_token'
Completed 500 Internal Server Error in 1007ms (ActiveRecord: 9.9ms | Allocations: 11913)


  
RuntimeError (Invalid response {
                    "requestId":"24453-100075214-1",
                    "errorCode": "404.001.03",
                    "errorMessage": "Invalid Access Token"
                }
             received.):
  
app/controllers/mpesas_controller.rb:46:in `block in stkpush'
app/controllers/mpesas_controller.rb:37:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 23:30:38 +0300
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.2ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mAccessToken Destroy (0.4ms)[0m  [1m[31mDELETE FROM "access_tokens" WHERE "access_tokens"."id" = ?[0m  [["id", 11]]
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (2.2ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:78:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:79:in `get_access_token'
  [1m[36mAccessToken Create (0.4ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "DCGacHjGIyKSGAlsx66ZzK9LbW0x"], ["created_at", "2023-03-18 20:30:39.134876"], ["updated_at", "2023-03-18 20:30:39.134876"]]
  â†³ app/controllers/mpesas_controller.rb:79:in `get_access_token'
  [1m[36mTRANSACTION (2.4ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:79:in `get_access_token'
Completed 500 Internal Server Error in 1152ms (ActiveRecord: 5.8ms | Allocations: 11497)


  
RuntimeError (Invalid response {
                    "requestId":"17588-57644564-1",
                    "errorCode": "404.001.03",
                    "errorMessage": "Invalid Access Token"
                }
             received.):
  
app/controllers/mpesas_controller.rb:46:in `block in stkpush'
app/controllers/mpesas_controller.rb:37:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 23:33:33 +0300
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.3ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mAccessToken Destroy (0.4ms)[0m  [1m[31mDELETE FROM "access_tokens" WHERE "access_tokens"."id" = ?[0m  [["id", 12]]
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mTRANSACTION (6.3ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mAccessToken Create (0.3ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "8DvFcQEZ68wEDz2n8xRZAEfqSd8s"], ["created_at", "2023-03-18 20:33:34.701942"], ["updated_at", "2023-03-18 20:33:34.701942"]]
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mTRANSACTION (3.0ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
Completed 500 Internal Server Error in 1172ms (ActiveRecord: 12.5ms | Allocations: 15180)


  
RuntimeError (Invalid response {
                    "requestId":"42516-39642558-1",
                    "errorCode": "404.001.03",
                    "errorMessage": "Invalid Access Token"
                }
             received.):
  
app/controllers/mpesas_controller.rb:47:in `block in stkpush'
app/controllers/mpesas_controller.rb:38:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 23:33:40 +0300
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.2ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mAccessToken Destroy (1.0ms)[0m  [1m[31mDELETE FROM "access_tokens" WHERE "access_tokens"."id" = ?[0m  [["id", 13]]
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mTRANSACTION (2.6ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mAccessToken Create (0.3ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "0w34GlxvAId8Z81Q2vSX5g03I98o"], ["created_at", "2023-03-18 20:33:41.074103"], ["updated_at", "2023-03-18 20:33:41.074103"]]
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mTRANSACTION (2.2ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
Completed 500 Internal Server Error in 796ms (ActiveRecord: 6.5ms | Allocations: 11925)


  
RuntimeError (Invalid response {
                    "requestId":"25710-100782215-1",
                    "errorCode": "404.001.03",
                    "errorMessage": "Invalid Access Token"
                }
             received.):
  
app/controllers/mpesas_controller.rb:47:in `block in stkpush'
app/controllers/mpesas_controller.rb:38:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 23:34:01 +0300
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"0715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"0715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.2ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mAccessToken Destroy (0.4ms)[0m  [1m[31mDELETE FROM "access_tokens" WHERE "access_tokens"."id" = ?[0m  [["id", 14]]
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mTRANSACTION (2.5ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mAccessToken Create (0.4ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "6Tc9xn8JiVXz90yS7a5EykO6loPg"], ["created_at", "2023-03-18 20:34:02.163453"], ["updated_at", "2023-03-18 20:34:02.163453"]]
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mTRANSACTION (2.3ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
Completed 500 Internal Server Error in 1111ms (ActiveRecord: 6.1ms | Allocations: 11567)


  
RuntimeError (Invalid response {
                    "requestId":"37392-98490736-1",
                    "errorCode": "404.001.03",
                    "errorMessage": "Invalid Access Token"
                }
             received.):
  
app/controllers/mpesas_controller.rb:47:in `block in stkpush'
app/controllers/mpesas_controller.rb:38:in `stkpush'
Started POST "/stkpush" for 41.80.113.195 at 2023-03-18 23:38:55 +0300
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by MpesasController#stkpush as */*
  Parameters: {"phoneNumber"=>"254715859934", "amount"=>"1", "mpesa"=>{"phoneNumber"=>"254715859934", "amount"=>"1"}}
  [1m[36mAccessToken Load (0.4ms)[0m  [1m[34mSELECT "access_tokens".* FROM "access_tokens"[0m
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mAccessToken Destroy (0.4ms)[0m  [1m[31mDELETE FROM "access_tokens" WHERE "access_tokens"."id" = ?[0m  [["id", 15]]
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mTRANSACTION (2.4ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:80:in `get_access_token'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[36mbegin transaction[0m
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mAccessToken Create (0.4ms)[0m  [1m[32mINSERT INTO "access_tokens" ("token", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["token", "xhG40l7GBqQckP2DeObvAk9sRYiJ"], ["created_at", "2023-03-18 20:38:55.760918"], ["updated_at", "2023-03-18 20:38:55.760918"]]
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
  [1m[36mTRANSACTION (3.2ms)[0m  [1m[36mcommit transaction[0m
  â†³ app/controllers/mpesas_controller.rb:81:in `get_access_token'
Completed 200 OK in 1426ms (Views: 0.5ms | ActiveRecord: 8.7ms | Allocations: 21189)


